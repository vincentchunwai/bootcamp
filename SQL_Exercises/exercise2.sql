CREATE TABLE WORKER (
  WORKER_ID SERIAL NOT NULL PRIMARY KEY,
  FIRST_NAME CHAR(25),
  LAST_NAME CHAR(25),
  SALARY NUMERIC(15),
  JOINING_DATE DATE,
  DEPARTMENT CHAR(25)
);

-- inesrt data to worker
INSERT INTO WORKER 
  (FIRST_NAME, LAST_NAME, SALARY, JOINING_DATE, DEPARTMENT) VALUES
    ('Monika', 'Arora', 100000, '21-02-20 09:00:00', 'HR'),
    ('Niharika', 'Verma', 80000, '21-06-11 09:00:00', 'Admin'),
    ('Vishal', 'Singhal', 300000, '21-02-20 09:00:00', 'HR'),
    ('Mohan', 'Sarah', 300000, '12-03-19 09:00:00', 'Admin'),
    ('Amitabh', 'Singh', 500000, '21-02-20 09:00:00', 'Admin'),
    ('Vivek', 'Bhati', 490000, '21-06-11 09:00:00', 'Admin'),
    ('Vipul', 'Diwan', 200000, '21-06-11 09:00:00', 'Account'),
    ('Satish', 'Kumar', 75000, '21-01-20 09:00:00', 'Account'),
    ('Geetika', 'Chauhan', 90000, '21-04-11 09:00:00', 'Admin');

-- create table bonus
CREATE TABLE BONUS (
  WORKER_REF_ID INTEGER,
  BONUS_AMOUNT NUMERIC(10),
  BONUS_DATE DATE,
  FOREIGN KEY (WORKER_REF_ID) REFERENCES Worker(WORKER_ID)
);

SELECT * FROM WORKER
INSERT INTO BONUS VALUES
	(6, 32000, '02-11-21'),
	(6, 20000, '02-11-22'),
	(5, 21000, '02-11-21'),
	(9, 30000, '02-11-21'),
	(8, 4500, '02-11-22')
SELECT * FROM WORKER W
LEFT JOIN BONUS B ON B.WORKER_REF_ID = W.WORKER_ID
ORDER BY W.WORKER_ID

SELECT SALARY AS SECOND_HIGHEST_SALARY
FROM WORKER
ORDER BY SALARY DESC LIMIT 1 OFFSET 1 

SELECT CONCAT(FIRST_NAME, LAST_NAME) AS EMPLOYEES_WITH_HIGHEST_SALARY
FROM WORKER
ORDER BY SALARY DESC LIMIT 3

SELECT W1.* 
FROM WORKER W1, WORKER W2
WHERE W1.SALARY = W2.SALARY
AND W1.WORKER_ID <> W2.WORKER_ID

SELECT CONCAT(W.FIRST_NAME, W.LAST_NAME) AS NAME, W.SALARY, B.BONUS_AMOUNT, B.BONUS_DATE
FROM WORKER W
LEFT JOIN BONUS B ON B.WORKER_REF_ID = W.WORKER_ID
WHERE EXTRACT(YEAR FROM B.BONUS_DATE) = 2021